webpackJsonp([28],{Jn86:function(e,t,r){"use strict";function o(e){r("OA3L")}Object.defineProperty(t,"__esModule",{value:!0});var a=r("nv77"),n={data:function(){var e=this,t=function(t,r,o){r!==e.editForm.pwd?o(new Error(e.$t("account.pwdNotMatch"))):o()};return{active:0,isChange:!1,loading:!1,roles:[],staffRoles:[],editFormRules:{user:[{required:!0,message:this.$t("account.userHolder"),trigger:"blur"},{min:8,max:16,message:this.$t("account.errLenHolder"),trigger:"blur"}],name:[{required:!0,message:this.$t("account.nameHolder"),trigger:"blur"}],phone:[{required:!0,message:this.$t("account.phoneHolder"),trigger:"blur"}],pwd:[{required:!0,message:this.$t("account.pwdHolder"),trigger:"blur"},{min:8,max:16,message:this.$t("account.errLenHolder"),trigger:"blur"}],repwd:[{required:!0,message:this.$t("account.repwdHolder"),trigger:"blur"},{min:8,max:16,message:this.$t("account.errLenHolder"),trigger:"blur"},{validator:t,trigger:"blur"}],rolesTxt:[{required:!0,message:this.$t("account.rolesHolder"),trigger:"blur"}]},editForm:{user:"",pwd:"",repwd:"",name:"",email:"",phone:"",rolesTxt:""}}},computed:{},mounted:function(){var e=this;this.$route.query.id&&(this.isChange=!0),a.a.getAllStaffRoles().then(function(t){e.staffRoles=t.data,e.roles=[],e.isChange&&a.a.getStaff(e.$route.query.id).then(function(t){e.editForm.name=t.data.nickname,t.data.roles.forEach(function(t){e.roles.push(t.role)})})}).catch(function(e){})},methods:{backForm:function(e){this.$router.back(-1)},resetForm:function(e){this.$refs[e].resetFields(),this.roles=[]},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var r=t.editForm,o=void 0;o=t.isChange?a.a.changeStaffRoles(t.$route.query.id,t.roles.join(".")):a.a.createStaff(r.user,r.pwd,r.name,r.phone,t.roles.join("."),r.email),t.loading=!0,o.then(function(e){t.loading=!1,t.$router.push({path:"/accountList"})}).catch(function(e){t.loading=!1})})}},watch:{roles:function(e,t){var r=this,o=[];e.forEach(function(e){r.staffRoles.forEach(function(t){e==t.role&&o.push(t.name)})}),this.editForm.rolesTxt=o.join(", ")}}},i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"tips"},[r("p",[e._v(e._s(e.$t("account.title")))])]),e._v(" "),r("div",{staticClass:"editForm"},[r("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"100px",rules:e.editFormRules}},[r("div",{staticClass:"allroles"},[r("el-checkbox-group",{model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}},[e._l(e.staffRoles,function(t){return[r("el-checkbox",{attrs:{label:t.role}},[e._v(e._s(t.name))])]})],2)],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("account.roles"),prop:"rolesTxt"}},[r("el-input",{attrs:{placeholder:e.$t("account.rolesHolder"),readonly:""},model:{value:e.editForm.rolesTxt,callback:function(t){e.$set(e.editForm,"rolesTxt",t)},expression:"editForm.rolesTxt"}})],1),e._v(" "),e.isChange?e._e():r("el-form-item",{attrs:{label:e.$t("account.user"),prop:"user"}},[r("el-input",{attrs:{placeholder:e.$t("account.userHolder")},model:{value:e.editForm.user,callback:function(t){e.$set(e.editForm,"user",t)},expression:"editForm.user"}})],1),e._v(" "),e.isChange?e._e():r("el-form-item",{attrs:{label:e.$t("account.pwd"),prop:"pwd"}},[r("el-input",{attrs:{placeholder:e.$t("account.pwdHolder"),type:"password"},model:{value:e.editForm.pwd,callback:function(t){e.$set(e.editForm,"pwd",t)},expression:"editForm.pwd"}})],1),e._v(" "),e.isChange?e._e():r("el-form-item",{attrs:{label:e.$t("account.repwd"),prop:"repwd"}},[r("el-input",{attrs:{placeholder:e.$t("account.repwdHolder"),type:"password"},model:{value:e.editForm.repwd,callback:function(t){e.$set(e.editForm,"repwd",t)},expression:"editForm.repwd"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("account.name"),prop:"name"}},[r("el-input",{attrs:{placeholder:e.$t("account.nameHolder"),readonly:e.isChange},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),e.isChange?e._e():r("el-form-item",{attrs:{label:e.$t("account.phone"),prop:"phone"}},[r("el-input",{attrs:{placeholder:e.$t("account.phoneHolder")},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1),e._v(" "),e.isChange?e._e():r("el-form-item",{attrs:{label:e.$t("account.email"),prop:"email"}},[r("el-input",{attrs:{placeholder:e.$t("account.emailHolder")},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),e._v(" "),r("div",{staticClass:"btn-commit"},[e.isChange?r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.backForm("editForm")}}},[e._v(e._s(e.$t("common.back")))]):e._e(),e._v(" "),e.isChange?e._e():r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.resetForm("editForm")}}},[e._v(e._s(e.$t("common.reset")))]),e._v(" "),r("el-button",{attrs:{type:"danger",loading:e.loading},on:{click:function(t){e.submitForm("editForm")}}},[e._v(e._s(e.$t("common.save")))])],1)],1)],1)])},l=[],s={render:i,staticRenderFns:l},c=s,d=r("VU/8"),u=o,m=d(n,c,!1,u,"data-v-6c069058",null);t.default=m.exports},OA3L:function(e,t,r){var o=r("aPM4");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);r("rjj0")("b807f1dc",o,!0,{})},aPM4:function(e,t,r){t=e.exports=r("FZ+f")(!1),t.push([e.i,"\n.tips[data-v-6c069058] {\r\n    font-size: 1.2rem;\r\n    color: #314558;\r\n    margin-top: 2rem;\r\n    margin-bottom: 2rem;\n}\n.btn-commit[data-v-6c069058] {\r\n    text-align: center;\n}\n.allroles[data-v-6c069058] {\r\n    margin-left: 100px;\r\n    margin-bottom: 1rem;\n}\r\n",""])}});