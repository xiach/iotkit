webpackJsonp([22],{"/v1R":function(t,e,i){e=t.exports=i("FZ+f")(!1),e.push([t.i,"\n.tips[data-v-7cd9081d] {\r\n    font-size: 1.2rem;\r\n    color: #314558;\r\n    margin-top: 2rem;\r\n    margin-bottom: 2rem;\n}\r\n",""])},CSAN:function(t,e,i){"use strict";function o(t){i("ikb2")}Object.defineProperty(e,"__esModule",{value:!0});var r=i("UgCr"),a={data:function(){return{products:[],faultcodes:[],repairblocks:[],hotline:"",isChange:!1,editLoading:!1,listLoadingFault:!1,listLoadingRepair:!1,fId:null,rId:null,productForm:{prodId:""},productFormRules:{prodId:[{required:!0,message:this.$t("message.productHolder"),trigger:"change"}]},editFormFaultVisible:!1,editFormFaultRules:{code:[{required:!0,message:this.$t("common.holderInput"),trigger:"blur"}],brief:[{required:!0,message:this.$t("common.holderInput"),trigger:"blur"}],solution:[{required:!0,message:this.$t("common.holderInput"),trigger:"blur"}],type:[{required:!0,message:this.$t("common.holderSelect"),trigger:"change"}]},editFormFault:{type:"",code:"",brief:"",solution:""},editFormRepairVisible:!1,editFormRepairRules:{name:[{required:!0,message:this.$t("common.holderInput"),trigger:"blur"}],phone:[{required:!0,message:this.$t("common.holderInput"),trigger:"blur"}],addr:[{required:!0,message:this.$t("common.holderInput"),trigger:"blur"}]},editFormRepair:{name:"",phone:"",addr:""}}},computed:{titleFault:function(){return this.isChange?this.$t("aftersale.titleMdyFault"):this.$t("aftersale.btnAddNewFault")},titleRepair:function(){return this.isChange?this.$t("aftersale.titleMdyRepair"):this.$t("aftersale.btnAddNewRepair")},types:function(){return[{key:"notice",label:this.$t("message.notice")},{key:"alarm",label:this.$t("message.alarm")}]}},mounted:function(){var t=this;this.products=[],r.a.getAllProducts().then(function(e){t.products=e.data.result}).catch(function(t){})},methods:{getTag:function(t){return"notice"==t?"success":"alarm"==t?"danger":void 0},typeFormatter:function(t,e){return"notice"==t.type?this.$t("message.notice"):"alarm"==t.type?this.$t("message.alarm"):void 0},getProductLabel:function(t){return t.model+"("+t.species+")"},updateFaultList:function(t){var e=this;this.listLoadingFault=!0,r.a.getAllFaultCode(t).then(function(t){e.listLoadingFault=!1,e.faultcodes=t.data.result}).catch(function(t){e.listLoadingFault=!1})},updateRepairList:function(t){var e=this;this.listLoadingRepair=!0,r.a.getAllRepairBlock(t).then(function(t){e.listLoadingRepair=!1,e.repairblocks=t.data.result}).catch(function(t){e.listLoadingRepair=!1})},handleAdd:function(t){var e=this;e.$refs.productForm.validate(function(i){if(!i)return!1;e.isChange=!1,"editFormRepair"==t?(e.editFormRepairVisible=!0,e.editFormFaultVisible=!1,e.editFormRepair.name="",e.editFormRepair.phone="",e.editFormRepair.addr=""):"editFormFault"==t&&(e.editFormFaultVisible=!0,e.editFormRepairVisible=!1,e.editFormFault.code="",e.editFormFault.type="",e.editFormFault.brief="",e.editFormFault.solution="")})},handleHotline:function(){var t=this,e=this;if(0==this.hotline.length||this.hotline.length>16)return void e.$message.error(e.$t("aftersale.errHotline"));e.$refs.productForm.validate(function(e){if(!e)return!1;t.$confirm(t.$t("common.toCommit"),t.$t("common.tip"),{type:"warning"}).then(function(){t.onHotline()}).catch(function(){})})},onHotline:function(){var t=this,e=this;this.editLoading=!0,r.a.changeHotline(this.productForm.prodId,this.hotline).then(function(i){t.editLoading=!1,e.$message.success(e.$t("common.tipSuccess"))}).catch(function(i){t.editLoading=!1,e.$message.error(e.$t("common.tipFailed"))})},handleEdit:function(t,e,i){var o=this;if(this.isChange=!0,"editFormFault"==i){var r=this.faultcodes[t];this.editFormFaultVisible=!0,this.fId=r.id,o.editFormFault.code=r.code,o.editFormFault.type=r.type,o.editFormFault.brief=r.brief,o.editFormFault.solution=r.solution}else{var a=this.repairblocks[t];this.editFormRepairVisible=!0,this.rId=a.id,o.editFormRepair.name=a.name,o.editFormRepair.phone=a.phone,o.editFormRepair.addr=a.addr}},handleDelete:function(t,e,i){var o=this;this.$confirm(this.$t("common.toCancel"),this.$t("common.tip"),{type:"warning"}).then(function(){o.onDelete(t,e,i)}).catch(function(){})},onDelete:function(t,e,i){var o=null,a=this;if("editFormFault"==i){var l=this.faultcodes[t];o=r.a.deleteFaultCode(this.productForm.prodId,l.id)}else{var n=this.repairblocks[t];o=r.a.deleteRepairBlock(this.productForm.prodId,n.id)}o.then(function(t){"editFormFault"==i?a.updateFaultList(a.productForm.prodId):"editFormRepair"==i&&a.updateRepairList(a.productForm.prodId),a.$message.success(a.$t("common.tipSuccess"))}).catch(function(t){a.$message.error(a.$t("common.tipFailed"))})},closeFaultDlg:function(){this.isChange=!1,this.editFormFaultVisible=!1},closeRepairDlg:function(){this.isChange=!1,this.editFormRepairVisible=!1},editSubmit:function(t){var e=this,i=this,o=null;i.$refs[t].validate(function(a){if(a){if("editFormFault"==t){var l=i.editFormFault;o=i.isChange?r.a.changeFaultCode(i.productForm.prodId,i.fId,l.brief,l.solution,l.type):r.a.addFaultCode(i.productForm.prodId,l.code,l.brief,l.solution,l.type)}else if("editFormRepair"==t){var n=i.editFormRepair;o=i.isChange?r.a.changeRepairBlock(i.productForm.prodId,i.rId,n.name,n.phone,n.addr):r.a.addRepairBlock(i.productForm.prodId,n.name,n.phone,n.addr)}o.then(function(o){"editFormFault"==t?(e.editFormFaultVisible=!1,i.updateFaultList(i.productForm.prodId)):"editFormRepair"==t&&(e.editFormRepairVisible=!1,i.updateRepairList(i.productForm.prodId)),i.$message.success(i.$t("common.tipSuccess"))}).catch(function(t){i.$message.error(i.$t("common.tipFailed"))})}})}},watch:{"productForm.prodId":function(t,e){var i=this;this.products.forEach(function(e){e.id==t&&(i.hotline=e.hotline)}),i.updateFaultList(t),i.updateRepairList(t)}}},l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"tips"},[i("p",[t._v(t._s(t.$t("route.productList")))])]),t._v(" "),i("el-form",{ref:"productForm",attrs:{model:t.productForm,"label-width":"100px",rules:t.productFormRules}},[i("el-form-item",{attrs:{label:t.$t("message.productHolder"),prop:"prodId"}},[i("el-select",{staticClass:"handle-select",model:{value:t.productForm.prodId,callback:function(e){t.$set(t.productForm,"prodId",e)},expression:"productForm.prodId"}},[t._l(t.products,function(e){return[i("el-option",{key:e.id,attrs:{label:t.getProductLabel(e),value:e.id}})]})],2)],1)],1),t._v(" "),i("div",{staticClass:"tips"},[i("p",[t._v(t._s(t.$t("aftersale.titleHotline")))])]),t._v(" "),i("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:t.$t("aftersale.titleHotline")},model:{value:t.hotline,callback:function(e){t.hotline=e},expression:"hotline"}}),t._v(" "),i("el-button",{attrs:{type:"success",loading:t.editLoading},on:{click:t.handleHotline}},[t._v(t._s(t.$t("common.commit")))]),t._v(" "),i("div",{staticClass:"tips"},[i("p",[t._v(t._s(t.$t("aftersale.titleFault")))])]),t._v(" "),i("el-button",{staticClass:"addparam",attrs:{type:"success"},on:{click:function(e){t.handleAdd("editFormFault")}}},[t._v(t._s(t.$t("aftersale.btnAddNewFault")))]),t._v(" "),t.editFormFaultVisible?i("el-dialog",{attrs:{title:t.titleFault,visible:t.editFormFaultVisible,"close-on-click-modal":!1,"before-close":t.closeFaultDlg}},[i("el-form",{ref:"editFormFault",attrs:{model:t.editFormFault,"label-width":"120px",rules:t.editFormFaultRules}},[i("el-form-item",{attrs:{label:t.$t("aftersale.code"),prop:"code"}},[i("el-input",{attrs:{placeholder:t.$t("common.holderInput"),readonly:t.isChange},model:{value:t.editFormFault.code,callback:function(e){t.$set(t.editFormFault,"code",e)},expression:"editFormFault.code"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("aftersale.brief"),prop:"brief"}},[i("el-input",{attrs:{placeholder:t.$t("common.holderInput")},model:{value:t.editFormFault.brief,callback:function(e){t.$set(t.editFormFault,"brief",e)},expression:"editFormFault.brief"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("aftersale.solution"),prop:"solution"}},[i("el-input",{attrs:{placeholder:t.$t("common.holderInput")},model:{value:t.editFormFault.solution,callback:function(e){t.$set(t.editFormFault,"solution",e)},expression:"editFormFault.solution"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("aftersale.type"),prop:"type"}},[i("el-select",{staticClass:"handle-select",attrs:{placeholder:t.$t("common.holderSelect")},model:{value:t.editFormFault.type,callback:function(e){t.$set(t.editFormFault,"type",e)},expression:"editFormFault.type"}},[t._l(t.types,function(t){return[i("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})]})],2)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.closeFaultDlg}},[t._v(t._s(t.$t("common.cancel")))]),t._v(" "),i("el-button",{attrs:{type:"danger",loading:t.editLoading},on:{click:function(e){t.editSubmit("editFormFault")}}},[t._v(t._s(t.$t("common.commit")))])],1)],1):t._e(),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoadingFault,expression:"listLoadingFault"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.faultcodes,border:"",strip:"",size:"mini"}},[i("el-table-column",{attrs:{type:"index",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{prop:"code",label:t.$t("aftersale.code"),width:"150"}}),t._v(" "),i("el-table-column",{attrs:{prop:"brief",label:t.$t("aftersale.brief")}}),t._v(" "),i("el-table-column",{attrs:{prop:"solution",label:t.$t("aftersale.solution")}}),t._v(" "),i("el-table-column",{attrs:{prop:"type",label:t.$t("aftersale.type"),width:"150",formatter:t.typeFormatter},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:t.getTag(e.row.type)}},[t._v(t._s(t.typeFormatter({type:e.row.type})))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:t.$t("common.operation"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button-group",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){t.handleEdit(e.$index,e.row,"editFormFault")}}},[t._v(t._s(t.$t("common.edit")))]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){t.handleDelete(e.$index,e.row,"editFormFault")}}},[t._v(t._s(t.$t("common.delete")))])],1)]}}])})],1),t._v(" "),i("div",{staticClass:"tips"},[i("p",[t._v(t._s(t.$t("aftersale.titleRepair")))])]),t._v(" "),i("el-button",{staticClass:"addparam",attrs:{type:"success"},on:{click:function(e){t.handleAdd("editFormRepair")}}},[t._v(t._s(t.$t("aftersale.btnAddNewRepair")))]),t._v(" "),t.editFormRepairVisible?i("el-dialog",{attrs:{title:t.titleRepair,visible:t.editFormRepairVisible,"close-on-click-modal":!1,"before-close":t.closeRepairDlg}},[i("el-form",{ref:"editFormRepair",attrs:{model:t.editFormRepair,"label-width":"120px",rules:t.editFormRepairRules}},[i("el-form-item",{attrs:{label:t.$t("aftersale.name"),prop:"name"}},[i("el-input",{attrs:{placeholder:t.$t("common.holderInput")},model:{value:t.editFormRepair.name,callback:function(e){t.$set(t.editFormRepair,"name",e)},expression:"editFormRepair.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("aftersale.phone"),prop:"phone"}},[i("el-input",{attrs:{placeholder:t.$t("common.holderInput")},model:{value:t.editFormRepair.phone,callback:function(e){t.$set(t.editFormRepair,"phone",e)},expression:"editFormRepair.phone"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("aftersale.addr"),prop:"addr"}},[i("el-input",{attrs:{placeholder:t.$t("common.holderInput")},model:{value:t.editFormRepair.addr,callback:function(e){t.$set(t.editFormRepair,"addr",e)},expression:"editFormRepair.addr"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.closeRepairDlg}},[t._v(t._s(t.$t("common.cancel")))]),t._v(" "),i("el-button",{attrs:{type:"danger",loading:t.editLoading},on:{click:function(e){t.editSubmit("editFormRepair")}}},[t._v(t._s(t.$t("common.commit")))])],1)],1):t._e(),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoadingRepair,expression:"listLoadingRepair"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.repairblocks,border:"",strip:"",size:"mini"}},[i("el-table-column",{attrs:{type:"index",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:t.$t("aftersale.name"),width:"150"}}),t._v(" "),i("el-table-column",{attrs:{prop:"phone",label:t.$t("aftersale.phone")}}),t._v(" "),i("el-table-column",{attrs:{prop:"addr",label:t.$t("aftersale.addr")}}),t._v(" "),i("el-table-column",{attrs:{label:t.$t("common.operation"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button-group",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){t.handleEdit(e.$index,e.row,"editFormRepair")}}},[t._v(t._s(t.$t("common.edit")))]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){t.handleDelete(e.$index,e.row,"editFormRepair")}}},[t._v(t._s(t.$t("common.delete")))])],1)]}}])})],1)],1)},n=[],s={render:l,staticRenderFns:n},d=s,c=i("VU/8"),u=o,m=c(a,d,!1,u,"data-v-7cd9081d",null);e.default=m.exports},ikb2:function(t,e,i){var o=i("/v1R");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i("rjj0")("2606e8ad",o,!0,{})}});